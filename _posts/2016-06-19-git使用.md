### git常用

#### 初始化
1. git init
2. git add .
3. git commit -m "first"

> 中间时不时的git status查看下状态.

#### 记住密码

```sh
git config --global credential.helper osxkeychain
```

#### 远程

1. 删除远程的库, 比如删除origin.

   ```sh
    git remote rm origin
   ```

2. 或者给现有的远程库改名.

   ```sh
    git remote rename pb paul
   ```

3. 添加远程库

   ```sh
    git remote add origin https://github.com/lornally/search-image.git
   ```

4. push

   ```sh
   git push -u origin master  #push失败, 需要先pull.
   git remote add origin https://github.com/lornally/okla_android.git
   git pull origin master   #pull也失败, 需要branch:
   git branch --set-upstream-to=origin/master master   
   ```

5. 总之都失败, 所以需要merge先:

   ```sh
   git merge  --allow-unrelated-histories
   git remote -v  #查看远程情况
   git remote show origin
   ```

### 查看各种git情况:

> git status
>
> git remote
>
> git branch
>
> git tag
>
> git show
>
> git log

#### git分支操作
1. 新建并切换到分支store

   ```sh
   git checkout -b store     #在目前分支的基础上生成新的分支store
   ```

2. 在新的分支上, 添加并提交

   ```sh
   git commit -a -m "add a new branch" #这个不是添加并提交. -a是说提交所有, 默认就是
   ```

3. 如果这是一个长期分支, 那么可以主动merge master, 保持针对主线的更新.

   ```sh
   git merge master
   git checkout master  #如果是临时分支, 可以回到主分支, 并将刚才的分支合并回主分支.
   git merge store
   ```

4. 如果要删除分支store

   ```sh
   git branch -d store  #这个分支就被干掉了, 一般长期使用的分支不需要这么干, 删除的一般都是短期的分支, 比如用来修复某个bug的分支.
   ```

#### 远程分支

1. pull = fetch + merge

   ```sh
   git fetch origin  #抓取源origin的master分支, 在本地成为origin/master分支, 注意这个分支不是本地的master分支, 我们可以手动合并到master分支. fetch只是把远程origin抓到本地origin/master.
   ```

2. 变基有两个命令 merge & rebase

   ```sh
   git checkout store #切换到store分支.
   git merge master #生成了一个新的版本, 合并了master到当前分支, 但是, master和store依旧是分叉的, 有分叉的过去和分叉的未来. 
   git rebase master #把master当做当前分支的基础, 这样master和store就没有分叉的历史了, 看上去也比较清爽, 而且也比较符合实际的业务逻辑. 这样当你推向主线的时候, 主线的管理者不需要merge了.
   ```

3. 只要你把变基命令当作是在推送前清理提交使之整洁的工具，并且只在从未推送至共用仓库的提交上执行变基命令，你就不会有事。

4. 实际操作

   ```sh
   git remote add origin https://github.com/lornally/g_php.git #添加一个远程的源
   git checkout -b weixin #本地建一个分支.
   git push origin weixin #把这个分支推到远程.
   git push #这里会失败, 因为要推送到weixin分支才行.
   git push --set-upstream origin weixin #这个是本地设置, 之后就可以git push了.
   ```

   ​

### git打标签

```sh
git tag -a v1.4 -m 'my version 1.4' #正常标签
git tag v1.4-lw   #轻量标签
git log|more  #查看log, 然后补标签
git tag -a v1.2 c03837698 -m "no bug release" #c03837698是前面log展示的, commit命令的那一串校验码的.
git tag #可以看到tag已经被打上了.
git push origin --tags #默认是不会推tag到远程的, 因此要推tag到远程, 就需要这样显式的推.
```

> 注意, git中其实并不能真正的检出一个标签, 标签只是一个标记, 真正检出的还是commit或者branch.

### git忽略

> git必须忽略某些文件, 比如log文件, 比如该死的[.DS_Store]

1. 默认忽略用ignore文件
   1. 注意： .gitignore 和 excludes只能忽略那些原来没有被track的文件，如果某些文件已经被纳入了版本管理中，则修改.gitignore是无效的。
   2. 因为, .gitignore这个文件是用于 untracked 文件的忽略列表,  用add将文件标记为 tracked 状态 .gitignore就对其无效了
2. git rm --cached filename  把他移除
3. 还可以
   1.   在每个clone下来的仓库中手动设置不要检查特定文件的更改情况。
   2.   git update-index --assume-unchanged PATH    在PATH处输入要忽略的文件。
   3.   取消这种设定可以使用:  git update-index --no-assume-unchanged
4. 另外 git 提供了一个全局的 .gitignore，你可以在你的用户目录下创建 ~/.gitignoreglobal 文件，以同样的规则来划定哪些文件是不需要版本控制的。
   - 需要执行 git config --global core.excludesfile ~/.gitignoreglobal来使得它生效
5. 参考这个很详细的说明: 
   1. http://blog.sina.com.cn/s/blog_601f224a01012a9r.html
   2. http://blog.csdn.net/xmyzlz/article/details/8592302



### 参考

- https://git-scm.com/book/en/v2
- [中文版](https://git-scm.com/book/zh/v1/Git-基础-远程仓库的使用)
- 用户名和密码的重复输入问题: https://help.github.com/articles/caching-your-github-password-in-git/
- 一个相当好的git简易入门: http://www.bootcss.com/p/git-guide/
